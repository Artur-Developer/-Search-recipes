"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var _Search=_interopRequireDefault(require("./models/Search")),_Recipe=_interopRequireDefault(require("./models/Recipe")),searchView=_interopRequireWildcard(require("./views/searchView")),recipeView=_interopRequireWildcard(require("./views/recipeView")),_base=require("./views/base");function _getRequireWildcardCache(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return _getRequireWildcardCache=function(){return e},e}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;if(null===e||"object"!==_typeof(e)&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache();if(r&&r.has(e))return r.get(e);var t,a={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in e){Object.prototype.hasOwnProperty.call(e,c)&&((t=n?Object.getOwnPropertyDescriptor(e,c):null)&&(t.get||t.set)?Object.defineProperty(a,c,t):a[c]=e[c])}return a.default=e,r&&r.set(e,a),a}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}require("./bootstrap");var state={},searchController=function(){var r;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=searchView.getInput())return state.search=new _Search.default(r),searchView.clearInput(),searchView.clearResult(),searchView.clearCountRecipes(),searchView.clearErrorMessage(),(0,_base.render_loader)(_base.elements.search_parent),e.next=10,regeneratorRuntime.awrap(state.search.getResults());e.next=16;break;case 10:e.sent||searchView.render_error(r),(0,_base.clearLoader)(),searchView.count_recipes(state.search.result.length),searchView.clearErrorMessage(),searchView.render(state.search.result);case 16:case"end":return e.stop()}})};_base.elements.search_form.addEventListener("submit",function(e){e.preventDefault(),searchController()}),_base.elements.results_page.addEventListener("click",function(e){var r,t=e.target.closest(".btn-inline");t&&(r=parseInt(t.dataset.goto,10),searchView.clearResult(),searchView.render(state.search.result,r))});var recipeController=function(){var r;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=window.location.hash.replace("#",""))return recipeView.clear_recipe(),(0,_base.render_loader)(_base.elements.recipe),state.recipe=new _Recipe.default(r),e.next=7,regeneratorRuntime.awrap(state.recipe.getRecipe());e.next=12;break;case 7:state.recipe.parseIngredients(),state.recipe.calcCookTime(),state.recipe.calcServings(),(0,_base.clearLoader)(),recipeView.renderRecipe(state.recipe);case 12:case"end":return e.stop()}})};["hashchange","load"].forEach(function(e){return window.addEventListener(e,recipeController)});